(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["post"],{"0390":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{ref:"tree",staticClass:"common_post container"},[a("div",{staticClass:"postPage_wrap"},[a("div",{staticClass:"left"},[a("div",{staticClass:"postPage_title"},[a("router-link",{staticClass:"tag",style:{backgroundColor:t.tagRandomBg},attrs:{to:{name:"searchresult",params:{text:t.postData.tag}}}},[t._v(t._s(t.postData.tag))]),a("h2",[t._v(t._s(t.postData.title))]),a("span",{staticClass:"time"},[a("i",{staticClass:"el-icon-time"}),t._v(t._s(t.formatTime))]),a("span",{staticClass:"views"},[a("i",{staticClass:"el-icon-view"}),t._v(t._s(t.postData.views))]),a("span",{staticClass:"comment"},[a("i",{staticClass:"el-icon-chat-dot-round"}),t._v(t._s(t.cmtTotal))])],1),a("div",{staticClass:"postPage_content"},[a("div",{staticClass:"img"},[a("img",{attrs:{src:t.defaultImg}})]),a("div",{staticClass:"content",domProps:{innerHTML:t._s(t.postData.content)}}),a("div",{staticClass:"mood"},[t._m(0),t._v(" "+t._s(t.mood)+" ")]),a("div",{staticClass:"toggle_post"},[a("div",{staticClass:"prev"},[a("span",[t._v("上一篇")]),t.prev._id?t._e():a("span",{staticClass:"null"},[t._v("没有了")]),t.prev._id?a("span",{staticClass:"prevTitle",on:{click:function(e){return t.togglePost(t.prev)}}},[t._v(t._s(t.prev.title?t.prev.title:"没有了"))]):t._e()]),a("div",{staticClass:"next"},[a("span",[t._v("下一篇")]),t.next._id?t._e():a("span",{staticClass:"null"},[t._v("没有了")]),t.next._id?a("span",{staticClass:"nextTitle",on:{click:function(e){return t.togglePost(t.next)}}},[t._v(t._s(t.next.title?t.next.title:"没有了"))]):t._e()])]),a("div",{staticClass:"like"},[a("like-post")],1),a("div",{staticClass:"comment_wrap"},[a("h2",{staticClass:"comment_title"},[t._v("发表评论")]),a("div",{directives:[{name:"show",rawName:"v-show",value:t.parentCmtData.name,expression:"parentCmtData.name"}],staticClass:"cancel"},[t._v("正在回复"),a("i",[t._v(t._s(t.parentCmtData.name))]),a("span",{on:{click:function(e){t.parentCmtData=""}}},[t._v("取消回复")])]),a("div",{staticClass:"form"},[a("b-form",{ref:"form",on:{submitForm:t.submitForm}})],1),a("div",{directives:[{name:"show",rawName:"v-show",value:0!==t.cmtTotal,expression:"cmtTotal !== 0"}],staticClass:"showComment"},[a("h2",[t._v("网友评论")]),t._l(t.cmtData,(function(e){return a("comment",{key:e._id,attrs:{id:e._id},on:{replyCmt:t.replyCmt}})}))],2),a("el-pagination",{attrs:{background:"",layout:"prev, pager, next","page-size":6,"hide-on-single-page":"",total:t.cmtTotal},on:{"current-change":t.cmtChangePaging}})],1)])]),a("div",{staticClass:"right"},[a("b-sidebar")],1)]),a("reading",{attrs:{percentage:t.percentage}})],1)},n=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("p",[a("i",{staticClass:"el-icon-sunrise-1"})])}],i=(a("b0c0"),a("365c")),o=a("511a"),r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"common_reading"},[a("el-progress",{attrs:{type:t.mType,percentage:+t.percentage,color:"#3545ee","stroke-width":3,width:80}})],1)},c=[],m=(a("a9e3"),{props:{percentage:{type:Number,default:0}},data:function(){return{screenWidth:"",mType:"circle"}},methods:{handleResize:function(){this.screenWidth=document.body.clientWidth}},mounted:function(){this.screenWidth=document.body.clientWidth,window.addEventListener("resize",this.handleResize),this.screenWidth>992?this.mType="circle":this.mType="line"},watch:{screenWidth:{handler:function(t){this.mType=t>992?"circle":"line"},deep:!0}},beforeDestroy:function(){window.removeEventListener("resize",this.handleResize)}}),l=m,d=a("2877"),u=Object(d["a"])(l,r,c,!1,null,null,null),h=u.exports,g=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"common_likePost"},[a("h2",{staticClass:"likeTitle"},[t._v("猜你喜欢")]),t._l(t.likePost,(function(t){return a("block-post",{key:t._id,attrs:{postData:t,num:50}})}))],2)},p=[],f=a("3c04"),v={components:{BlockPost:f["a"]},data:function(){return{likePost:[]}},methods:{getLikePost:function(){var t=this;i["a"].getRandomPost({params:{postNum:3}}).then((function(e){200===e.data.code&&e.data.data&&(t.likePost=e.data.data)}))}},created:function(){this.getLikePost()}},A=v,C=Object(d["a"])(A,g,p,!1,null,null,null),B=C.exports,_=a("8f6a"),F=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"post_comment"},[a("div",{staticClass:"commentTemp clearboth"},[t._m(0),a("div",{staticClass:"right_content"},[a("div",{staticClass:"right_top"},[a("span",{staticClass:"name"},[t._v(t._s(t.data.name))]),a("span",{staticClass:"time"},[t._v(t._s(t.newTime))]),t.data.parentCmtId?t._e():a("span",{staticClass:"reply",on:{click:function(e){return t.$emit("replyCmt",t.data)}}},[t._v("回复")])]),a("div",{staticClass:"content"},[t._v(t._s(t.data.content))])])]),0!==t.cmtList.length?a("div",{staticClass:"cmtChildren"},t._l(t.cmtList,(function(t){return a("comment-template",{key:t._id,attrs:{id:t._id}})})),1):t._e()])},w=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"left_img"},[s("img",{attrs:{src:a("e967")}})])}],b=a("c1df"),D=a.n(b),Q=a("4260"),E={name:"comment-template",props:{id:String},data:function(){return{data:"",parentName:"",parentId:"",cmtList:[]}},computed:{newTime:function(){var t=D()(this.data.time).format("YYYY-MM-DD, hh:mm");return t}},methods:{getComment:function(t){var e=this;i["a"].getOneComment({params:{id:t}}).then((function(t){var a=t.data;200===a.code&&a.data._id&&(e.data=a.data)}))},getChildCmt:function(t){var e=this;i["a"].getAllChildCmt({params:{id:t}}).then((function(t){var a=t.data;200===a.code&&a.data&&(e.cmtList=a.data)}))}},created:function(){this.getComment(this.id),this.getChildCmt(this.id)}},x=E,j=Object(d["a"])(x,F,w,!1,null,null,null),k=j.exports,P={inject:["reload"],components:{BSidebar:o["a"],Reading:h,LikePost:B,BForm:_["a"],Comment:k},data:function(){return{percentage:0,scrollHeight:0,scroll:0,id:"",postData:{},next:{},prev:{},mood:"",pageNum:1,cmtNum:6,cmtTotal:0,cmtData:[],parentCmtData:"",tagBg:["#f9c100","#4ca80b","#ff7500","#ee303a","#0ab3af","#fc4a00","#0085FF","#6555E2"],defaultImgSrc:a("42ef")}},methods:{handleScroll:function(){this.scrollHeight=document.documentElement.scrollHeight;var t=this.scrollHeight-document.body.clientHeight,e=t/100;this.scroll=document.documentElement.scrollTop,this.percentage=Math.ceil(this.scroll/e)},getOnePost:function(){var t=this;i["a"].getOnePost({params:{postId:this.id}}).then((function(e){200===e.data.code&&e.data.data&&(t.postData=e.data.data,t.postData.content=JSON.parse(t.postData.content))}))},getBrotherPost:function(t){var e=this;i["a"].getBrotherPost({params:{postId:t}}).then((function(t){var a=t.data;200===a.code&&a.data&&(e.next=a.data.next,e.prev=a.data.prev)}))},togglePost:function(t){this.$router.push({name:"post",params:{type:t.parent,id:t._id}})},getPostComment:function(){var t=this;i["a"].getPostAllComment({params:{postId:this.id,pageNum:this.pageNum,cmtNum:this.cmtNum}}).then((function(e){200===e.data.code&&"无评论"!==e.data.data&&(t.cmtTotal=e.data.data.total,t.cmtData=e.data.data.data)}))},getMood:function(){var t=this;i["a"].getRandomMood().then((function(e){200===e.data.code&&e.data.data&&(t.mood=e.data.data.content)}))},submitForm:function(t){var e=this;""===this.parentCmtData?this.$confirm("确定发布评论吗？","",{confirmButtonText:"确定",cancelButtonText:"取消",type:"info "}).then((function(){i["a"].addComment({parentId:e.postData._id,name:Object(Q["a"])(t.name),email:Object(Q["a"])(t.email),content:Object(Q["a"])(t.content)}).then((function(t){200===t.data.code&&t.data.data._id?(alert("发布成功"),e.$refs.form.$children[0].$el[0].value="",e.$refs.form.$children[0].$el[1].value="",e.$refs.form.$children[0].$el[2].value="",e.$router.go(0)):alert("发布失败")}))})):this.$confirm("确定对<<".concat(this.parentCmtData.name,">>进行评论吗？"),"",{confirmButtonText:"确定",cancelButtonText:"取消",type:"info "}).then((function(){i["a"].replyComment({postId:e.id,parentCmtId:e.parentCmtData._id,name:Object(Q["a"])(t.name),email:Object(Q["a"])(t.email),content:Object(Q["a"])(t.content)}).then((function(t){var a=t.data;200===a.code&&a.data._id?(e.$refs.form.$children[0].$el[0].value="",e.$refs.form.$children[0].$el[1].value="",e.$refs.form.$children[0].$el[2].value="",e.parentCmtData="",alert("发布成功"),e.$router.go(0)):alert("发布失败")}))}))},replyCmt:function(t){this.parentCmtData=t,window.scrollTo(0,this.$refs.form.$el.offsetTop-100),this.$refs.form.$children[0].$el[0].focus()},cmtChangePaging:function(t){this.pageNum=t,this.getPostComment()}},computed:{tagRandomBg:function(){return this.tagBg[Object(Q["c"])(0,this.tagBg.length)]},formatTime:function(){return Object(Q["b"])(this.postData.time)},defaultImg:function(){return this.postData.imgSrc?this.postData.imgSrc:this.defaultImgSrc}},created:function(){this.id=this.$route.params.id,this.getOnePost(),this.getBrotherPost(this.id),this.getPostComment(),this.getMood()},mounted:function(){window.scrollTo(0,0),this.scrollHeight=document.documentElement.scrollHeight,window.addEventListener("scroll",this.handleScroll)},watch:{$route:function(){var t=this.$loading({lock:!0,text:"正在加载",background:"rgb(255,255,255)"});this.id="",this.postData={},this.next={},this.prev={},this.mood="",this.pageNum=1,this.cmtNum=6,this.cmtTotal=0,this.cmtData=[],this.parentCmtData="",this.id=this.$route.params.id,this.getOnePost(),this.getBrotherPost(this.id),this.getPostComment(),this.getMood(),setTimeout((function(){window.scrollTo(0,0),t.close()}),800)}},destroyed:function(){window.removeEventListener("scroll",this.handleScroll)}},y=P,T=(a("fdeb"),Object(d["a"])(y,s,n,!1,null,null,null));e["default"]=T.exports},"1b36":function(t,e,a){},"8f6a":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"common_form"},[a("el-form",{ref:"msgForm",staticClass:"demo-ruleForm",attrs:{model:t.msgForm,"status-icon":"",rules:t.rules}},[a("el-form-item",{staticClass:"name",attrs:{prop:"name"}},[a("el-input",{attrs:{type:"text",placeholder:"昵称*",autocomplete:"off"},on:{blur:t.checkName},model:{value:t.msgForm.name,callback:function(e){t.$set(t.msgForm,"name",e)},expression:"msgForm.name"}})],1),a("el-form-item",{staticClass:"email",attrs:{prop:"email"}},[a("el-input",{attrs:{type:"text",placeholder:"邮箱*",autocomplete:"off"},model:{value:t.msgForm.email,callback:function(e){t.$set(t.msgForm,"email",e)},expression:"msgForm.email"}})],1),a("el-form-item",{staticClass:"content",attrs:{prop:"content"}},[a("el-input",{attrs:{type:"textarea",rows:5,maxlength:"50",placeholder:"请输入留言内容"},model:{value:t.msgForm.content,callback:function(e){t.$set(t.msgForm,"content",e)},expression:"msgForm.content"}})],1),a("el-form-item",{staticClass:"btn"},[a("p",{staticClass:"clearboth"},[a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.submitForm("msgForm")}}},[t._v("发布")])],1)])],1)],1)},n=[],i=(a("b0c0"),a("5530")),o=a("365c"),r=a("4260"),c={data:function(){return{msgForm:{name:"",email:"",content:""},rules:{name:[{required:!0,message:"请输入昵称",trigger:"blur"},{min:2,max:6,message:"长度在 2 到 6 个字符",trigger:"blur"},{type:"string",whitespace:!0}],email:[{required:!0,message:"请输入邮箱地址",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:["blur","change"]},{type:"string",whitespace:!0}],content:[{required:!0,message:"请输入留言内容",trigger:"blur"},{min:1,max:50,message:"长度不超过50个字符",trigger:"blur"},{type:"string",whitespace:!0}]}}},methods:{submitForm:function(t){var e=this,a=Object(i["a"])({},this.msgForm);this.$refs[t].validate((function(t){if(e.msgForm.name=Object(r["a"])(e.msgForm.name),e.msgForm.email=Object(r["a"])(e.msgForm.email),e.msgForm.content=Object(r["a"])(e.msgForm.content),!t)return alert("未通过验证，请检查后重试"),!1;e.$emit("submitForm",a),e.msgForm.content=""}))},checkName:function(){this.msgForm.name&&o["a"].checkName({params:{name:Object(r["a"])(this.msgForm.name)}}).then((function(t){var e=t.data;"昵称重复"===e.data&&alert("昵称重复请更换")}))},successMsg:function(){this.content=""}},beforeDestroy:function(){this.msgForm.name="",this.msgForm.email="",this.msgForm.content=""}},m=c,l=a("2877"),d=Object(l["a"])(m,s,n,!1,null,null,null);e["a"]=d.exports},e967:function(t,e){t.exports="data:image/png;base64,/9j/4AAQSkZJRgABAQEAYABgAAD//gA7Q1JFQVRPUjogZ2QtanBlZyB2MS4wICh1c2luZyBJSkcgSlBFRyB2NjIpLCBxdWFsaXR5ID0gOTAK/9sAQwADAgIDAgIDAwMDBAMDBAUIBQUEBAUKBwcGCAwKDAwLCgsLDQ4SEA0OEQ4LCxAWEBETFBUVFQwPFxgWFBgSFBUU/9sAQwEDBAQFBAUJBQUJFA0LDRQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQU/8AAEQgAPAA8AwEiAAIRAQMRAf/EAB8AAAEFAQEBAQEBAAAAAAAAAAABAgMEBQYHCAkKC//EALUQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQygZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29/j5+v/EAB8BAAMBAQEBAQEBAQEAAAAAAAABAgMEBQYHCAkKC//EALURAAIBAgQEAwQHBQQEAAECdwABAgMRBAUhMQYSQVEHYXETIjKBCBRCkaGxwQkjM1LwFWJy0QoWJDThJfEXGBkaJicoKSo1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoKDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uLj5OXm5+jp6vLz9PX29/j5+v/aAAwDAQACEQMRAD8A+t8CjFJ+VH5UALgUYFavh3w1e+JrwwWiDavMkr8Ig9z/AEr0S1+DenrEBc31zJJjkxBUH5EGgDybAowK7/xF8JrmwgefTZzeooyYXXEmPbHB+nFcAQQcHg+lABgUYFJ+VH5UALn3oz70fjRzQB734F0iPR/DNkigCSZBNK3cswz+gwPwrfz71jeDdTTVfDOnzI2SsSxuPRlGD/LP41tc0AJn3rxX4o6RHpfiUywgJHdJ5xAHAbJDfyz+Ne1814z8WdTS98SJBG24WsQRiP7xJJH6igDis+9Gfej8aPx/SgA/Oj86MfWux+HPg1fEV611dqTYW5GV/wCej9dv07n8PWgDS+F1nr0E5ntowulyn959oJVX90759+ler/nSJGI0VFUKqjAVeABTsGgDM8Q/2odMlGkCL7WRgGY4wPbtn68V4BqVrdWd7NFexyx3QYlxL94k9/fPrX0lj61z3jLwjB4p05lwEvYwTDN3B/un2NAHgv50fnT54JLaaSGVGSSNirKeoI4IpmPrQAfhX0J4T0hdE8PWVqFw4jDSe7nk/qf0rwGxjWS9t1YZVpFBH419K4FACY9qMe1GKMUAGPajHtRjrRigDxv4s6Qtj4hjukXCXce44/vjg/pj864nHtXqnxmjU2WmPj5hI4B+oH+FeVgAigD/2Q=="},fdeb:function(t,e,a){"use strict";var s=a("1b36"),n=a.n(s);n.a}}]);
//# sourceMappingURL=post.0316a139.js.map